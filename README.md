# 📊 月次報告書 自動統合マクロ（Excel VBA）

## 📌 概要

このExcelマクロは、複数の部門ごとに分かれて保存されている**月次報告書や勤務記録、チェックリスト**などのファイルから、  
特定のキーワードを含むシートだけを抽出し、**1つのExcelブックに自動でまとめる**ツールです。

---

## 🧾 想定用途

- 毎月の部門別報告書の取りまとめ  
- 管理職への月次提出用資料の集約  
- チェックリスト・勤務記録など様式別の統合  
- VBAやRPA初心者の事務職でも扱いやすいツールとして活用可能  

---

## 🛠️ 使い方

1. このExcelファイルを任意のフォルダに配置  
2. 下記のフォルダ構成を準備  
3. マクロを実行すると、各「個別」フォルダ内のExcelから該当シートを集めて、  
各部門フォルダに「統合ファイル（例：202504_部門A_報告書.xlsx）」として保存されます。

---

## ⚙️ カスタマイズ可能な設定

| 項目             | 内容                                           |
|------------------|------------------------------------------------|
| `folderPaths`    | 各部門の個別ファイルが格納されているフォルダ |
| `sheetKeywords`  | 抽出対象のシート名に含まれるキーワード        |
| `fileNamePrefixes` | 出力ファイル名の接頭語（部門名＋用途）     |

---

## 💬 補足

- シート名が重複する場合、自動で連番（_1, _2...）が付与されます  
- 不正なシート名文字（例：/、\\、* など）は除去されます  
- エラー処理、進行状況の通知も付いており安心して利用できます  

---

## 🧑‍💼 想定ユーザー

- Excelが使える一般事務職
- VBAは触ったことないけど簡単な業務自動化をしたい方
- 定型的な報告業務が毎月発生するチーム・部門

---

## 🖥️ 動作環境

- Windows + Excel（Office 2016以降推奨）
- マクロが有効な状態（xlsmファイル）

---

## 📂 ファイル構成

- `Consolidation_macro.xlsm`：マクロ付きExcelファイル（コード内蔵）
- `README.md`：このファイル

---

## ✅ 今後追加してもいい機能

- サブフォルダ探索（再帰的）
- 検出ログの出力
- 処理件数の進捗バー
- シート内容の一括整形（列幅やフォント統一）

---

## 最後に

事務作業の手間を減らせたらいいなと思って作りました。  
ぜひ改善やアレンジを加えて使ってください。
